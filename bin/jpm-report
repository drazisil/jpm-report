#!/usr/bin/env node

var jpm_report = require('../src/index.js')

jpm_report.checkArgs(process.argv, function cb_parse_args (err, res) {
  if (err) {
    console.log(err)
    process.exit(1)
  } else {
    res = JSON.parse(res)
    if (res.success.total_success === res.success.total_tests) {
      process.stdout.write('<testsuite errors="0" failures="0" name="" tests="' + res.success.total_tests + '" time="223">')
      process.stdout.write('<testcase classname="main"></testcase>')
      process.stdout.write('</testsuite>')
      process.exit()
    } else {
      process.stdout.write(res.success.total_success + ' of ' + res.success.total_tests + ' passed')
      process.exit(1)
    }
  }
})
